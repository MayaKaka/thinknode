<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	<script src="../jquery/jquery-1.11.1.min.js"></script>
	<script src="../jquery/require.min.js"></script>
	<script src="../cartoon/excanvas.js"></script>
	<link rel="stylesheet" href="../jquery/bootstrap.min.css">
	<style>
	
		html {height:100%;}
		body {height:100%;background:#fff;color:#000;}
		.display { overflow: hidden; width: 100%; }
		.div-container, .cvs-container { float: left; border:#0E97E6 solid 1px; margin: 5px; position:relative; }
		.control {clear: both;}
		.control label { margin:5px 5px 0 8px; }
	</style>
</head>
<body>
	<div class="display">
		<div class="div-container"></div>
		<canvas class="cvs-container"></canvas>
	</div>
	
	<div class="control">
		<input type="button" value="rain" id="rain">
		<input type="button" value="snow" id="snow">
		<input type="button" value="fire" id="fire">
		<div id="fps">0</div>
	</div>
<script>

	require.config({
		baseUrl: '../cartoon/',
		paths: {
			cartoon: 'cartoon'
		}
	});
	require(['cartoon'], function(ct){
		
		var divContainer = $('.div-container').cartoon({
			size: { width: 600, height: 300 }
		});
		divContainer.$.css('overflow', 'hidden');
		
		var cvsContainer = $('.cvs-container').cartoon({
			type: 'Canvas',
			size: { width: 600, height: 300 }
		});
		
		var divBg = $.cartoon({
			type: 'Shape',
			graphics: {
				type: 'Rect', color: 'top,#66D,#AAF', width: 600, height: 300
			}
		});
		
		var cvsBg = $.cartoon({
			type: 'Shape',
			renderInCanvas: true,
			graphics: {
				type: 'Rect', color: 'top,#66D,#AAF', width: 600, height: 300
			}
		});
		
		var divParticle = $.cartoon({
			type: 'ParticleSystem',
			particle: {
				type: 'Rain'
			}
		});
		
		var cvsParticle = $.cartoon({
			type: 'ParticleSystem',
			renderInCanvas: true,
			particle: {
				type: 'Rain'
			}
		});
		
		divContainer.addChild(divBg);
		divContainer.addChild(divParticle);
		
		cvsContainer.addChild(cvsBg);
		cvsContainer.addChild(cvsParticle);
		
		var ticker = new ct.Ticker(60, 'auto', false);
		ticker.add(divParticle);
		ticker.add(cvsParticle);
		ticker.add(cvsContainer);
		ticker.add(function(){
			$('#fps').html(ticker.fps);
		});
		ticker.start();		
		
		$('.control').bind('click', function(e) {
			var id = e.target.id;
			divParticle.elem.innerHTML = '';
			cvsParticle._children = [];
			switch(id) {
				case 'rain':
					divParticle._initParticle({ type: 'Rain' });
					cvsParticle._initParticle({ type: 'Rain' });
					break;
				case 'snow':
					divParticle._initParticle({ type: 'Snow' });
					cvsParticle._initParticle({ type: 'Snow' });
					break;
				case 'fire':

					break;
			}
		});
	});
</script>
</body>
</html>