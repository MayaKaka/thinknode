<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
  <link rel="stylesheet" href="../jquery/bootstrap.min.css">
  <script src="../jquery/jquery-1.11.1.min.js"></script>
  <script src="../jquery/require.min.js"></script>
  <script src="../cartoon/excanvas.js"></script>
  <style>
  	html { font-family: "Helvetica Neue", Helvetica, Microsoft Yahei, Hiragino Sans GB, WenQuanYi Micro Hei, sans-serif;  }
    .op-doc-header { padding: 30px 15px; color: #FFF; height: 200px; background-color: #6f5499; background-image: linear-gradient(to bottom,#563d7c 0,#6f5499 100%); }
  	.op-doc-header h1 { font-size: 60px;  }
  	.op-doc-header p { font-size: 24px; margin-left: 6px; color: #CDCDCD; }
  	.op-doc-main { padding: 30px 15px; }
  </style>
  <script>
    require.config({ baseUrl: '../cartoon/', paths: { cartoon: 'cartoon' }});
  </script>
</head>
<body>
<div class="op-doc-header">
  <div class="container">
    <h1>特效库    API 设计</h1>
    <p>图形，图像，动画，事件</p>
  </div>
</div>
<div class="op-doc-main">
  <div class="container">
  	<div class="row">
  	  <div class="col-md-9">
  	  	<h1 class="page-header">概览</h1>
  	  	<p class="lead">结合 Web 开发人员的思维习惯，设计合理的 API 风格，可参考 <a href="http://www.createjs.com/" target="_blank">createjs</a></p>
  	  	
  	  	<!--  Class  -->
  	  	<h3 id="base-class">Class</h3>
		<p>类式继承基类，参考 <a href="http://ejohn.org/blog/simple-javascript-inheritance" target="_blank">simple-javascript-inheritance</a></p>
		<p><pre>
<code class="html">var Person = Class.extend({
   init: function() {
      console.log('hello!');
   }
});
var Student = Person.extend({
   init: function() {
      this._super();
      console.log('I am a student!');
   }
});
var student = new Student();</code>
		</pre></p>
		
		<!--  Ticker  -->
		<h3 id="base-ticker">Ticker</h3>
		<p>高频计时器</p>
		<p><pre>
<code class="html">var ticker = new Ticker(30, 'auto');
ticker.add(function(delta){
    console.log(delta);	
});
ticker.start();</code>
		</pre></p>
		<div><script>
require(['cartoon'], function(ct){
	var ticker = new ct.Ticker(60, 'auto');
	ticker.start();
	window.glTicker = ticker;
});		  
		</script></div>
		
		<!--  Matrix2D  -->
		<h3 id="base-matrix">Matrix2D</h3>
		<p>2D矩阵，参考 <a href="http://www.eleqtriq.com/wp-content/static/demos/2010/css3d/matrix2dexplorer.html" target="_blank">matrix-explorer</a></p>
		<p><pre>
<code class="html">var matrix = new Matrix2D();
matrix.append(1, 0, 0, 1, 50, 50);</code>
		</pre></p>
		
		<!--  EventDispatcher  -->
		<h3 id="base-dispatcher">EventDispatcher</h3>
		<p>事件派发器，参考 <a href="http://help.adobe.com/zh_CN/AIR/1.5/jslr/flash/events/EventDispatcher.html" target="_blank">as3-EventDispatcher</a></p>
		<p><pre>
<code class="html">var dispatcher = new EventDispatcher();
dispatcher.bind('click', function(e){
   console.log(this);
});
dispatcher.trigger(new Event('click'));</code>
		</pre></p>
		
		<!--  EventDispatcher  -->
		<h3 id="base-display">DisplayObject</h3>
		<p>基础显示对象，参考 <a href="http://help.adobe.com/zh_CN/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#" target="_blank">as3-DisplayObject</a></p>
		<p><pre>
<code class="html">var displayObj = new DisplayObject({
   elem: document.getElementById('ball'),
   x: 300, y: 150, width: 100, height: 100
});</code>
		</pre></p>
		
		<!--  Shape  -->
		<h3 id="base-shape">Shape</h3>
		<p>基础图形对象，参照 <a href="http://www.w3school.com.cn/svg/svg_rect.asp" target="_blank">svg-shapes</a></p>
		<p><pre>
<code class="html">var rect = new Shape({
   graphics: { type: 'rect', fill: 'red', width: 100, height: 100 }
});</code>
		</pre></p>	
		<div><canvas id="cvs-shape"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-shape'),
	    width: 850, height: 150
	});
	var rect = new ct.Shape({
		renderInCanvas: true,
		graphics: { type: 'rect', fill: 'top,#8AF,#248', width: 100, height: 100 }
	});
	var circle = new ct.Shape({
		renderInCanvas: true,
		x: 110, y: 2,
		graphics: { type: 'circle', fill: 'top,#F00,#FF0', radius: 50, angle: 300 }
	});
	var ellipse = new ct.Shape({
		renderInCanvas: true,
		x: 220, y: 2,
		graphics: { type: 'ellipse', stroke: '#242', fill: '#4DF', radiusX: 30, radiusY: 60 }
	});
	var line = new ct.Shape({
		renderInCanvas: true,
		x: 290, y: 2,
		graphics: { type: 'line', stroke: '#F00',
			path: [[0, 50], [10, 50], [20, 0], [30, 70], [40, 30], [50, 90], [60, 50], [70, 50], [80, 20], [90, 50], [100, 50]]}
	});
	var ploygon = new ct.Shape({
		renderInCanvas: true,
		x: 350, y: 2,
		graphics: { type: 'ploygon', stroke: '#00F', fill: 'images/mali.jpg',
			points: [[0, 100], [60, 70], [60, 30], [100, 0], [120, 120]]}
	});
	var star = new ct.Shape({
		renderInCanvas: true,
		x: 470, y: 2,
		graphics: { type: 'polyStar', stroke: '#FD8', fill: 'top,#FD8,#333',
			radius: 60, sides: 6 }
	});
	var star1 = new ct.Shape({
		renderInCanvas: true,
		x: 580, y: 2,
		graphics: { type: 'polyStar', stroke: '#FF0', fill: '#F00',
			radius: 60, sides: 5, cohesion: 0.4 }
	});
	var lines = new ct.Shape({
		renderInCanvas: true,
		x: 690, y: 2,
		graphics: { type: 'lines', stroke: '#444',
			paths: [[[0, 100], [130, 100]],
					[[100, 0], [100, 130]],
	  				[[90, 5], [90, 60, 60, 90, 5, 90]],
					[[80, 10], [120, 120, 10, 80]]
			]}
	});
	canvas.addChild(rect);
	canvas.addChild(circle);
	canvas.addChild(ellipse);
	canvas.addChild(line);
	canvas.addChild(ploygon);
	canvas.addChild(star);
	canvas.addChild(star1);
	canvas.addChild(lines);
	canvas.update();
	setTimeout(function(){
		canvas.update();
	}, 200);
});
		</script></div>
		
		<!--  Bitmap  -->
		<h3 id="base-bitmap">Bitmap</h3>
		<p>位图，滤镜</p>
		<p><pre>
<code class="html">var bmp = new Bitmap({
   imageUrl: 'images/logo.png', sourceRect: [0, 0, 120, 30]
});</code>
		</pre></p>
		<div><canvas id="cvs-bitmap"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-bitmap'),
	    width: 850, height: 150
	});
	var bmp0 = new ct.Bitmap({
		renderInCanvas: true,
		x: 0, y: 0, imageUrl: 'images/mali.jpg',
		sourceRect: [ 110,70, 160, 150 ]
	});
	var bmp1 = new ct.Bitmap({
		renderInCanvas: true,
		x: 200, y: 0, imageUrl: 'images/mali.jpg',
		sourceRect: [ 110,70, 160, 150 ]
	});
	var bmp2 = new ct.Bitmap({
		renderInCanvas: true,
		x: 400, y: 0, imageUrl: 'images/mali.jpg',
		sourceRect: [ 110,70, 160, 150 ]
	});
	canvas.addChild(bmp0);
	canvas.addChild(bmp1);
	canvas.addChild(bmp2);
	canvas.update();
	setTimeout(function(){
		bmp1.applyFilter('grayscale');
		bmp2.applyFilter('brightness');
		canvas.update();
	}, 200);
});		  		  
		</script></div>
		
		<!--  Text  -->
		<h3 id="base-text">Text</h3>
		<p>文本</p>
		<p><pre>
<code class="html">var txt = new Text({
   text: 'Hello World', font: '20px Arail', fill: 'red'
});</code>
		</pre></p>
		<div><canvas id="cvs-text"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-text'),
	    width: 850, height: 150
	});
	var txt = new ct.Text({
		renderInCanvas: true,
		x: 320, y:50,
		text: 'Hello World', font: '30px Arail', fill: 'red'
	});
	canvas.addChild(txt);
	canvas.update();
});		  		  
		</script></div>
	
		<!--  Tween  -->
		<h3 id="base-tween">Tween</h3>
		<p>补间动画</p>
		<p><pre>
<code class="html">displayObj.to({ x: 350, transform: { rotate: 45 }, alpha: 0.2 }, 300, 'linear')
          .to({ y: 150, transform: { scale: 1.5 }, alpha: 1 }, 300, 'easeIn');</code>
		</pre></p>
		<div><canvas id="cvs-tween"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-tween'),
	    width: 850, height: 150
	});
	var rect = new ct.Shape({
		renderInCanvas: true,
		x: 5, y: 25, 
		graphics: { type: 'rect', fill: '#F00', width: 100, height: 100, stroke: '#000' }
	});
	rect.on('click', function(){
		rect.to({ x: 300, alpha: 0.2, fill: '#0FF' }, 600, 'easeOut')
			.to({ x: 700, alpha: 1, fill: '#F0F' }, 600, 'easeIn')
			.to({ transform: { scale: 0.5, rotate: 360 }}, 1000, 'backOut')
			.to({ transform: { scale: 1, rotate: 0 }}, 1000, 'backIn')
			.to({ x: 5, fill: '#F00' }, 1000, 'bounceOut');
	});	
	canvas.addChild(rect);
	
	var ticker = window.glTicker;
	ticker.add(canvas);
});		  		  
		</script></div>
		
		<!--  Timeline  -->
		<h3 id="base-line">Timeline</h3>
		<p>时间轴动画</p>
		<p><pre>
<code class="html">var timeline = new Timeline();
timeline.addKeyFrame(circle, { x: 0 }, 0).addKeyFrame(circle, { x: 300 }, 300);
timeline.addKeyFrame(rect, { x: 300 }, 0).addKeyFrame(rect, { x: 0 }, 300);</code>
		</pre></p>
		<div><canvas id="cvs-line"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-line'),
	    width: 850, height: 150
	});
	var circle = new ct.Shape({
		renderInCanvas: true,
		graphics: { type: 'circle', radius: 50, fill: '#F00' }
	});
	var rect = new ct.Shape({
		renderInCanvas: true,
		graphics: { type: 'rect', width: 60, height: 60, fill: '#00F' }
	});
	canvas.addChild(circle);
	canvas.addChild(rect);
	var timeline = new ct.Timeline();
	timeline.addKeyFrame(rect, { x: 0, y: 40 }, 0)
			.addKeyFrame(rect, { x: 700, y: 40, transform: { rotate: 720 } }, 1500)
			.addKeyFrame(rect, { x: 0, transform: { rotate: 0 } }, 3000);
	timeline.addKeyFrame(circle, { x: 700, y: 20, transform: { scale: 2 } }, 0)
			.addKeyFrame(circle, { x: 700, y: 20, transform: { scale: 0.2 } }, 1500)
			.addKeyFrame(circle, { transform: { scale: 2 } }, 3000);
	
	var ticker = window.glTicker;
	ticker.add(timeline);
	ticker.add(canvas);
});		  		  
		</script></div>
				
		<!--  Sprite  -->
		<h3 id="base-sprite">Sprite</h3>
		<p>精灵，帧动画</p>
		<p><pre>
<code class="html">var sprite = new Sprite({
   spriteSheet: {
      frames: { width: 60, height: 120, num: 64, cols: 12, rows: 6 },
      animations: { jump: [26, 63, 'run', 0], run: [0, 25, 'run', 0] },
      images: [ 'images/runner.png' ]
   }
});</code>
		</pre></p>
		<div><canvas id="cvs-sripte"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-sripte'),
	    width: 850, height: 150
	});
	var sprite = new ct.Sprite({
		renderInCanvas: true,
		x: 0, y: 0, 
		transform: { scale: 0.5 },
		spriteSheet: {
        	frames: { width: 165, height: 292, num: 64, cols: 12, rows: 6 },
            animations: { jump: [26, 63, 'run', 0], run: [0, 25, 'run', 0] },
            images: [ 'images/runningGrant.png' ]
        }
	});
	sprite.play('run');
	canvas.addChild(sprite);
		
	var ticker = window.glTicker;
	ticker.add(sprite);
	ticker.add(function(){
		if (sprite.x > 850) {
			sprite.style('x', -165);
		} else {
			sprite.style('x', sprite.x+3);
			if (sprite.x>400 && sprite.x<(400+3)) {
				sprite.play('jump');
			}
		}
	});
	ticker.add(canvas);
});		  		  
		</script></div>
		
		<!--  ParticleSystem  -->
		<h3 id="base-particle">ParticleSystem</h3>
		<p>粒子动画</p>
		<p><pre>
<code class="html">var particles = new ParticleSystem({
   particle: {
      type: 'rain', width: 850, height: 150	
   }
});</code>
		</pre></p>
		<div><canvas id="cvs-particle"></canvas>
		  <script>
require(['cartoon'], function(ct){
	var canvas = new ct.Canvas({
	    elem: document.getElementById('cvs-particle'),
	    width: 850, height: 150
	});
	var background = new ct.Shape({
	    renderInCanvas: true,
	    graphics: {
	    	type: 'rect', width: 850, height: 150, fill: 'top,#66D,#AAF'
	    }
	});
	var particles = new ct.ParticleSystem({
		renderInCanvas: true,
		particle: {
			type: 'rain', width: 850, height: 150
		}
	});
	canvas.addChild(background);
	canvas.addChild(particles);
		
	var ticker = window.glTicker;
	ticker.add(particles);
	ticker.add(canvas);
});
		</script></div>
		
		<!--  BoneAnimation  -->
		<h3 id="base-bone">BoneAnimation</h3>
		<p>骨骼动画</p>
		<p><pre>
<code class="html">todo...
</code>
		</pre></p>
		
		<!--  Ease  -->
		<h3 id="base-ease">Ease</h3>
		<p>扩展动画函数</p>
		<p><pre>
<code class="html">jQuery.extend( Ease.easing, {
	easeIn: function(x, t, b, c, d) {
		return c*(t/=d)*t + b;
  	}  
});
obj.to({ x: 60 }, 300, 'easeIn');</code>
		</pre></p>
				
		<!--  Filter  -->
		<h3 id="base-filter">Filter</h3>
		<p>扩展滤镜</p>
		<p><pre>
<code class="html">jQuery.extend( Filter.filters, {
	highlight: function(image) {
  		var canvas = document.createElement('canvas');
  		canvas.drawImage(image, 0, 0);
  		// todo handle pixels
  		return canvas;
  	}  
});
img.applyFilter('highlight');</code>
		</pre></p>
				
		<!--  StyleSheet  -->
		<h3 id="base-style">StyleSheet</h3>
		<p>扩展样式</p>
		<p><pre>
<code class="html">jQuery.extend( StyleSheet.styles, {
	opacity: {
		get: function(target, key) {
			return target.opacity;   
		},
		set: function(target, key, value) {
			target.opacity = value;
			if (!target.renderInCanvas) {
				target.elem.style.opacity = value;
			}
		},
		step: function(target, key, fx) {
			var pos = fx.pos,
				start = fx.start,
				end = fx.end;
			target.style('opacity', (end-start)*pos+start);
		}
	}
});
displayObj.style('opacity', 0.5);</code>
		</pre></p>
		
		<!--  Graphics2D  -->
		<h3 id="base-graphics">Graphics2D</h3>
		<p>扩展图形</p>
		<p><pre>
<code class="html">jQuery.extend( Graphics2D.shapes, {
	newShape: {
  		init: function(graphics) {
  			this.width = graphics.width;
  			this.height = graphics.height;
  		},
  		draw: function(ctx) {
  			ctx.fillRect(0, 0, this.width, this.height);
  		}
  	}  
});
new Shape({ graphics: { type: 'newShape', width: 100, height: 30 } });</code>
		</pre></p>		

		<!--  ParticleEmitter  -->
		<h3 id="base-emitter">ParticleEmitter</h3>
		<p>扩展粒子效果</p>
		<p><pre>
<code class="html">jQuery.extend( ParticleEmitter.particles, {
	snow: {
  		init: function(particle) {
  			this.particles = [];
  			this.num = particle.num;
  			// todo add particles
  		},
  		update: function(delta) {
  			// todo animation
  		}
  	}  
});
new ParticleSystem({ particle: { type: 'snow', num: 60 } });</code>
		</pre></p>

		<!--  TextEffect  -->
		<h3 id="base-txteff">TextEffect</h3>
		<p>扩展文本特效</p>
		<p><pre>
<code class="html">todo...
</code>
		</pre></p>
		
  	  </div>
  	  <div class="col-md-3">
  	  	<div>
  	  	  <h5>基础组件</h5>
  	      <ul class="nav">
	        <li><a href="#base-class">Class</a></li>
	        <li><a href="#base-ticker">Ticker</a></li>
	        <li><a href="#base-matrix">Matrix2D</a></li>
	        <li><a href="#base-dispatcher">EventDispatcher</a></li>
	      </ul>
	      <h5>渲染组件</h5>
  	      <ul class="nav">
	        <li><a href="#base-display">DisplayObject</a></li>
	        <li><a href="#base-shape">Shape</a></li>
	        <li><a href="#base-bitmap">Bitmap</a></li>
	        <li><a href="#base-text">Text</a></li>
	      </ul>
	      <h5>动画组件</h5>
  	      <ul class="nav">
	        <li><a href="#base-tween">Tween</a></li>
	        <li><a href="#base-line">Timeline</a></li>
	        <li><a href="#base-sprite">Sprite</a></li>
	        <li><a href="#base-particle">ParticleSystem</a></li>
	        <li><a href="#base-bone">BoneAnimation</a></li>
	      </ul>
	      <h5>如何扩展</h5>
  	      <ul class="nav">
	        <li><a href="#base-ease">Ease</a></li>
	        <li><a href="#base-filter">Filter</a></li>
	        <li><a href="#base-style">StyleSheet</a></li>
	        <li><a href="#base-graphics">Graphics2D</a></li>
	        <li><a href="#base-emitter">ParticleEmitter</a></li>
	        <li><a href="#base-txteff">TextEffect</a></li>
	      </ul>
	      <h5>API 示例</h5>
  	      <ul class="nav">
  	      	<li><a href="ticker.html" target="_blank">ticker</a></li>
  	      	<li><a href="transform.html" target="_blank">transform</a></li>
	        <li><a href="lines.html" target="_blank">lines</a></li>
	        <li><a href="tween.html" target="_blank">tween</a></li>
	        <li><a href="bones.html" target="_blank">bones</a></li>
	        <li><a href="box2d.html" target="_blank">box2d</a></li>
	        <li><a href="touch.html" target="_blank">touch</a></li>
	        <li><a href="cache.html" target="_blank">cahce</a></li>
	      </ul>
	    </div>
  	  </div>
  	</div>
  </div>	
</div>
<div>
</div>
</body>
</html>